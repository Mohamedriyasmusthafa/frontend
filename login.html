<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="login-container">
    <h2>Login</h2>
    <select id="role">
        <option value="">Select Role</option>
        <option value="admin">Admin</option>
        <option value="staff">Staff</option>
        <option value="student">Student</option>
    </select>
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button onclick="login()">Login</button>
    <p id="errorMsg"></p>
</div>

<script>
async function login(){
    const role = document.getElementById('role').value;
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;

    if(!role || !username || !password){
        document.getElementById('errorMsg').textContent = "Fill all fields";
        return;
    }

    const res = await fetch('http://localhost:3000/auth/login',{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({username,password})
    });

    const data = await res.json();
    if(res.ok){
        if(data.role!==role){
            document.getElementById('errorMsg').textContent="Role mismatch";
            return;
        }
        if(role==='admin') window.location.href='admin.html';
        else if(role==='staff') window.location.href='staff.html';
        else window.location.href='student.html';
    }else{
        document.getElementById('errorMsg').textContent=data.message;
    }
}
</script>
</body>
</html>
